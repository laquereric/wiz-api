# frozen_string_literal: true

module Wiz
  module Models
    # Represents a WIZ Vulnerability Finding
    class Vulnerability < Base
      attr_reader :name, :severity, :cvss_score, :cve_id, :detected_at,
                  :description, :remediation, :affected_assets, :vendor_severity

      private

      def load_attributes(data)
        super
        @name = data["name"]
        @severity = data["severity"]
        @cvss_score = data["cvssScore"]
        @cve_id = data["cveId"]
        @detected_at = parse_time(data["detectedAt"])
        @description = data["description"]
        @remediation = data["remediation"]
        @affected_assets = data["affectedAssets"] || []
        @vendor_severity = data["vendorSeverity"]
      end

      def parse_time(time_string)
        return nil if time_string.nil?

        Time.parse(time_string)
      rescue ArgumentError
        nil
      end
    end
  end
end

